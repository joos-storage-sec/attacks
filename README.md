# attacks
Уязвимости и атаки на информационные системы

**Исследование сетей**

Первым этапом любой атаки является исследование (exploration, разведка) атакуемой системы.

Основные задачи исследования сети:
- построение топологии сети;
- перечисление доступных сетевых узлов;
- обнаружение сетевых служб хостов.

Основные средства исследования сети:
- анализаторы пакетов (Wireshark);
- сканеры сети (nmap);
- сканеры уязвимостей (Nessus);
- средства создания пакетов (HPing).

**NMAP: возможности**
- обнаружение хостов в сети;
- обнаружение открытых портов хоста;
- определение сетевых служб хоста;
- сканирование диапазона IP-адресов (в том числе в сети Интернет);
- автоматизация поиска и дальнейшего исследования при помощи файлов сценариев (скриптов)

**NMAP: установка**

Nmap – стандарт средств сканирования сети, поэтому установлен по умолчанию в любой ОС, ориентированной на исследования в области безопасности.

Для самостоятельной установки нужно перейти на сайт - https://nmap.org

И в разделе загрузки (Download) выбрать версию для нужной ОС - https://nmap.org/download.html

**NMAP: основные режимы сканирования**
- -sS: TCP SYN-сканирование
- -sT: TCP connect-сканирование
- -sА: TCP FIN-сканирование
- -sU: UDP-сканирование
- -sX: Xmas-сканирование
- -PR: ARP-пинг
- --traceroute: трассировка пути
- -R: разрешение имен DNS
- -n: запрещение разрешения имен DNS
- -sL: создать список хостов
**NMAP: агрессивный режим сканирования** - Агрессивный режим сканирования (-A) – наиболее часто используемый режим сканирования. Предоставляет дополнительную информацию о хосте.

**NMAP: определение версий ПО на сервере** - nmap -sV scanme.nmap.org

**Hydra** – программа для подбора паролей.

Частичный список поддерживаемых протоколов: Cisco *, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, ICQ, IMAP, IRC, LDAP, MS-SQL, MYSQL, Oracle *, PC-Anywhere, POP3, POSTGRES, RDP, Rlogin, SAP/R3, SIP, SMB, SMTP, SNMP, SOCKS5, SSH (v1, 2), SSHKEY, Teamspeak (TS2), Telnet, VNC. Домашняя страница: https://github.com/vanhauser-thc/thc-hydra

Выполним атаку на подбор пароля:
```
hydra -L users.txt -P pass.txt 192.168.0.5 ssh
```
**ARP-spoofing** – атака, использующая особенность протокола ARP, которая позволяет обработать ARP-ответ без предварительного ARP- запроса (протокол ARP не сохраняет свое состояние, stateless protocol). Данная атака позволяет злоумышленнику перехватывать трафик между узлами локальной сети и является разновидностью MITM-атак (Man In The Middle, человек посередине).

**MITM (Man In The Middle, человек посередине, атака посредника)** – атака, в результате которой атакующий скрытно принимает и передает информацию между двумя узлами. При этом атакуемые узлы считают, что общаются друг с другом напрямую

**DoS (Denial of Service, отказ в обслуживании)** – атака, направленная на исчерпание одного или нескольких ресурсов системы («перегрузка системы»). Результатом такой атаки является прекращение работы системы либо ее значительное замедление.

**DDoS (Distributed Denial of Service, распределенный по источникам отказ в обслуживании)** – вариант DoS-атаки, в котором целевая система атакуется сразу из множества источников. DDoS – атака, в результате которое большое количество сетевых узлов устраивает DoS-атаку на одну цель. Чаще всего для таких атак создаются ботнеты (сети из большого количества устройств под управлением атакующего)

**DDoS: реальные атаки**

В феврале 2020 года на Amazon Web Services была осуществлена одна из самых больших DDoS-атак за всю историю. Атака продолжалась три дня и в своем пике достигала трафика в 2,3 Тб/с 19 сентября 2016 года один из самых больших европейских хостинг- провайдеров OVH (примерно 18 million приложения для более чем миллиона клиентов) был атакован ботнетом Mirai состоящим из 145,000 узлов, генерирующим трафик до 1.1 Тб\с в течении семи дней

21 октября 2016 один из основных DNS-провайдеров Dyn был атакован тем же Mirai. В этой атаке трафик достига 1,5 Тб\с. В результате почти все службы Dyn оказались заблокированы, что отразилось на работе таких гигантов как GitHub, HBO, Twitter, Reddit, PayPal, Netflix и Airbnb.

28 февраля 2018 года был атакован GitHub. Трафик доходил до 1,35 Тб\с и длился примерно 20 минут. Несмотря на то что GitHub был готов к подобного рода атакам, против нагрузки подобного масштаба «устоять» не получилось.

**DoS: slow attack**

Slow attack – тип DoS-атак, при котором трафик, идущий на сервер, довольно маленький, т.е. не оказывает никакого влияния на канал связи. Особенностью этих атак является длительное время выполнения (slow).

Теперь предположим, что кто-то решил передавать приведенный выше запрос примерно по такой временной диаграмме:
- Connection: keep-alive
- <пауза 15 минут>
- Host: 127.0.0.1:8000
- <пауза 15 минут>
- Connection: keep-alive
- <пауза 15 минут>

Более того, даже один заголовок можно передавать аналогично:
- A
- <пауза 15 минут>
- с
- <пауза 15 минут>
- с
- <пауза 15 минут>
- e ... и т.д

**DoS: slow body**

Данный тип атаки аналогичен slow headers, только в этом случае медленно передается тело запроса (может быть любым):
- ...
- body = a...a...a...a...a...a...
- ...

**DoS: range attack (Apache killer)**

Производит манипуляции с HTTP-заголовком Range. Apache 1.3.x, 2.0.0-2.0.64, 2.2.0-2.2.19 (CVE-2011-3192: Apache range header handling vulnerability)

**DoS: slow read**

Медленное чтение – данная атака аналогична медленной записи, и использует особенности протоколов HTTP и TCP. На сервере выбирается большой ресурс и, манипулируя значением окна TCP (например, приравнивая его нулю), вызывается постоянное увеличение используемой памяти.

**Metasploit**

Metasploit – один из самых популярных фреймворков (framework) для тестирования на проникновение (пентест, pentest, penetration test)*. Metasploit имеет большое количество модулей, «связанных» собственной локальной БД, и развитое сообщество. *Тестирования на проникновение – легальная и согласованная эмуляция кибератаки на систему.

Metasploit появился в 2003 году, и в начале был реализован на Perl. Примерно в 2007 году был полностью переписан на Ruby и в 2009 году стал коммерческим проектом (после покупки проекта Rapid7).

Metasploit: возможности
- Сбор информации (Information Gathering, Enumeration)
- Получение доступа (Gaining Access)
- Повышение привилегий (Privilege Escalation)
- Расширение присутствия/доступа (Maintaining Access)
- Маскировка присутствия (Covering Tracks)

Metasploit: модули
- Auxiliaries (вспомогательные модули)
- Exploits
- Encoders (кодировщики)
- Payloads (полезная нагрузка)
- Post (пост эксплуатация)
